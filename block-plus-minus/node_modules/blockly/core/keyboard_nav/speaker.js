goog.provide('Blockly.Speaker');


Blockly.Speaker = function(workspace) {
  this.workspace = workspace;

};

Blockly.Speaker.prototype.init = function() {
  var speakerDiv = document.createElement('div');
  speakerDiv.setAttribute('id', 'speakerDiv');
  // speakerDiv.setAttribute('aria-label', '');
  speakerDiv.setAttribute('aria-live', 'assertive');
  Blockly.utils.aria.setRole(speakerDiv, 'alert');
  document.body.appendChild(speakerDiv);
  this.workspace.addChangeListener(Blockly.Speaker.speak);
};

Blockly.Speaker.speak = function(e) {
  // TODO: Have this use blockly.msg so people can change the marker text.
  if (e.element === 'cursorMove' || e.element === 'markerMove') {
    var speakerDiv = document.getElementById('speakerDiv');
    var newNode = e.newValue;
    var newNodeText = newNode.toText();
    if (e.element === 'markerMove') {
      var markerText = 'Marker moved to location ';
      newNodeText = markerText + newNodeText;
    }
    speakerDiv.textContent = newNodeText;
    // speakerDiv.setAttribute('aria-label', newNodeText);
  }
};
